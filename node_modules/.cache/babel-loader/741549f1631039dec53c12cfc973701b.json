{"ast":null,"code":"import _regeneratorRuntime from\"/home/anandraj/Desktop/jabtrac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/anandraj/Desktop/jabtrac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import jquery from\"jquery\";import{LOGIN_SUCCESS,LOGIN_FAIL,LOAD_USER_SUCCESS,LOAD_USER_FAILS,AUTHENTICATED_SUCCESS,AUTHENTICATED_FAIL,LOGOUT,SIGN_UP_SUCCESS,SIGN_UP_FAIL,EMPLOYEE_LIST_SUCCESS,EMPLOYEE_LIST_FAILED}from\"./Types\";import{jsx as _jsx}from\"react/jsx-runtime\";export var load_user=function load_user(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.getItem(\"token\")){_context.next=14;break;}config={headers:{\"Content-Type\":\"application/json\",Authorization:\"token \".concat(localStorage.getItem(\"token\")),Accept:\"application/json\",'X-CSRFToken':csrftoken}};_context.prev=2;_context.next=5;return axios.get(\"http://127.0.0.1:8000/accounts/user/\",config);case 5:res=_context.sent;dispatch({type:LOAD_USER_SUCCESS,payload:res.data});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);dispatch({type:LOAD_USER_FAILS});case 12:_context.next=15;break;case 14:dispatch({type:LOAD_USER_FAILS});case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\",'X-CSRFToken':csrftoken}};body=JSON.stringify({email:email});_context2.prev=2;_context2.next=5;return axios.post(\"http://127.0.0.1:8000/accounts/login/\",body,config);case 5:res=_context2.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(load_user());_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);dispatch({type:LOGIN_FAIL});case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[2,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var signup=function signup(email,domain,password){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,domain:domain,password:password});_context3.prev=2;_context3.next=5;return axios.post('http://127.0.0.1:8000/accounts/register/',body,config);case 5:res=_context3.sent;dispatch({type:SIGN_UP_SUCCESS,payload:res.data});_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);dispatch({type:SIGN_UP_FAIL});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[2,9]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var checkAuthenticated=function checkAuthenticated(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!localStorage.getItem('token')){_context4.next=16;break;}config={headers:{\"Content-Type\":\"application/json\",Authorization:\"token \".concat(localStorage.getItem(\"token\")),Accept:\"application/json\",'X-CSRFToken':csrftoken}};_context4.prev=2;_context4.next=5;return axios.get(\"http://127.0.0.1:8000/accounts/user/\",config);case 5:res=_context4.sent;dispatch(load_user());dispatch({type:AUTHENTICATED_SUCCESS,payload:res.data});dispatch(load_user());_context4.next=14;break;case 11:_context4.prev=11;_context4.t0=_context4[\"catch\"](2);dispatch({type:AUTHENTICATED_FAIL});case 14:_context4.next=17;break;case 16:dispatch({type:AUTHENTICATED_FAIL});case 17:case\"end\":return _context4.stop();}}},_callee4,null,[[2,11]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};var csrftoken=getCookie('csrftoken');var CSRFToken=function CSRFToken(){return/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"csrfmiddlewaretoken\",value:csrftoken});};export default CSRFToken;function getCookie(name){var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jquery.trim(cookies[i]);if(cookie.substring(0,name.length+1)===name+'='){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}return cookieValue;}export var logout=function logout(){return function(dispatch){if(localStorage.getItem(\"token\")){// const config = {\n//   headers: {\n//     \"Content-Type\": \"application/json\",\n//     Authorization: `token ${localStorage.getItem(\"token\")}`,\n//     Accept: \"application/json\",\n//     'X-CSRFToken': csrftoken\n//   },\n// };\ntry{var res=axios.post(\"http://127.0.0.1:8000/accounts/logout/\");console.log('logout success');dispatch({type:LOGOUT,payload:res.data});}catch(err){dispatch({type:LOGOUT});}}};};export var employeecount=function employeecount(){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!localStorage.getItem(\"token\")){_context5.next=14;break;}config={headers:{\"Content-Type\":\"application/json\",Authorization:\"token \".concat(localStorage.getItem(\"token\")),Accept:\"application/json\",'X-CSRFToken':csrftoken}};_context5.prev=2;_context5.next=5;return axios.get(\"http://127.0.0.1:8000/accounts/count/\",config);case 5:res=_context5.sent;dispatch({type:EMPLOYEE_LIST_SUCCESS,payload:res.data});_context5.next=12;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](2);dispatch({type:EMPLOYEE_LIST_FAILED});case 12:_context5.next=15;break;case 14:dispatch({type:EMPLOYEE_LIST_FAILED});case 15:case\"end\":return _context5.stop();}}},_callee5,null,[[2,9]]);}));return function(_x5){return _ref5.apply(this,arguments);};}();};","map":{"version":3,"sources":["/home/anandraj/Desktop/jabtrac/src/Actions/Auth.js"],"names":["axios","jquery","LOGIN_SUCCESS","LOGIN_FAIL","LOAD_USER_SUCCESS","LOAD_USER_FAILS","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","LOGOUT","SIGN_UP_SUCCESS","SIGN_UP_FAIL","EMPLOYEE_LIST_SUCCESS","EMPLOYEE_LIST_FAILED","load_user","dispatch","localStorage","getItem","config","headers","Authorization","Accept","csrftoken","get","res","type","payload","data","login","email","body","JSON","stringify","post","signup","domain","password","checkAuthenticated","getCookie","CSRFToken","name","cookieValue","document","cookie","cookies","split","i","length","trim","substring","decodeURIComponent","logout","console","log","err","employeecount"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport jquery from \"jquery\";\nimport {\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  LOAD_USER_SUCCESS,\n  LOAD_USER_FAILS,\n  AUTHENTICATED_SUCCESS,\n  AUTHENTICATED_FAIL,\n  LOGOUT,\n  SIGN_UP_SUCCESS,\n  SIGN_UP_FAIL,\n  EMPLOYEE_LIST_SUCCESS,\n  EMPLOYEE_LIST_FAILED\n} from \"./Types\";\n\n\n\n\nexport const load_user = () => async (dispatch) => {\n  if (localStorage.getItem(\"token\")) {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `token ${localStorage.getItem(\"token\")}`,\n        Accept: \"application/json\",\n        'X-CSRFToken': csrftoken\n      },\n    };\n\n    try {\n      const res = await axios.get(\n        `http://127.0.0.1:8000/accounts/user/`,\n        config\n      );\n\n      dispatch({\n        type: LOAD_USER_SUCCESS,\n        payload: res.data,\n      });\n    } catch (err) {\n      dispatch({\n        type: LOAD_USER_FAILS,\n      });\n    }\n  } else {\n    dispatch({\n      type: LOAD_USER_FAILS,\n    });\n  }\n};\n\n\n\nexport const login = (email) => async (dispatch) => {\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      'X-CSRFToken': csrftoken\n    },\n  };\n\n\n  const body = JSON.stringify({ email });\n\n  try {\n    const res = await axios.post(\n      `http://127.0.0.1:8000/accounts/login/`,\n      body,\n      config\n    );\n\n    dispatch({\n      type: LOGIN_SUCCESS,\n      payload: res.data,\n    });\n\n    dispatch(load_user());\n  } catch (err) {\n    dispatch({\n      type: LOGIN_FAIL,\n    });\n  }\n};\n\n\nexport const signup = (email, domain, password) => async dispatch => {\n  const config = {\n      headers: {\n          'Content-Type': 'application/json'\n      }\n  };\n\n  const body = JSON.stringify({  email, domain, password });\n\n  try {\n      const res = await axios.post('http://127.0.0.1:8000/accounts/register/', body, config);\n\n      dispatch({\n          type: SIGN_UP_SUCCESS,\n          payload: res.data\n      });\n  } catch (err) {\n      dispatch({\n          type: SIGN_UP_FAIL\n      })\n  }\n};\n\n\nexport const checkAuthenticated = () => async dispatch => {\n  if (localStorage.getItem('token')) {\n      const config = {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `token ${localStorage.getItem(\"token\")}`,\n            Accept: \"application/json\",\n            'X-CSRFToken': csrftoken,\n          }\n      }; \n\n      try {\n        const res = await axios.get(\n          `http://127.0.0.1:8000/accounts/user/`,\n          config\n        );\n        dispatch(load_user()); \n        dispatch({\n          type: AUTHENTICATED_SUCCESS,\n          payload: res.data,\n        });\n\n      dispatch(load_user());  \n      } catch (err) {\n        dispatch({\n          type: AUTHENTICATED_FAIL,\n        });\n      }\n    } else {\n      dispatch({\n        type: AUTHENTICATED_FAIL,\n      });\n    }\n  };\n\n\n\nvar csrftoken = getCookie('csrftoken');\n\nconst CSRFToken = () => {\n    return (\n        <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value={csrftoken} />\n    );\n};\nexport default CSRFToken;\n\n\nfunction getCookie(name) {\n    var cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        var cookies = document.cookie.split(';');\n        for (var i = 0; i < cookies.length; i++) {\n            var cookie = jquery.trim(cookies[i]);\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\n\n\n\nexport const logout = () => (dispatch) => {\n  if (localStorage.getItem(\"token\")) {\n    // const config = {\n    //   headers: {\n    //     \"Content-Type\": \"application/json\",\n    //     Authorization: `token ${localStorage.getItem(\"token\")}`,\n    //     Accept: \"application/json\",\n    //     'X-CSRFToken': csrftoken\n    //   },\n    // };\n\n    try {\n      const res = axios.post(\n        `http://127.0.0.1:8000/accounts/logout/`,\n      );\n        console.log('logout success')\n      dispatch({\n        type: LOGOUT,\n        payload: res.data,\n      });\n    } catch (err) {\n      dispatch({\n        type: LOGOUT,\n      });\n    }\n  }\n}\n  \n\n\nexport const employeecount = () => async (dispatch) => {\n  if (localStorage.getItem(\"token\")) {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `token ${localStorage.getItem(\"token\")}`,\n        Accept: \"application/json\",\n        'X-CSRFToken': csrftoken\n      },\n    };\n\n    try {\n      const res = await axios.get(\n        `http://127.0.0.1:8000/accounts/count/`,\n        config\n      );\n\n      dispatch({\n        type: EMPLOYEE_LIST_SUCCESS,\n        payload: res.data,\n      });\n    } catch (err) {\n      dispatch({\n        type: EMPLOYEE_LIST_FAILED,\n      });\n    }\n  } else {\n    dispatch({\n      type: EMPLOYEE_LIST_FAILED,\n    });\n  }\n};"]},"metadata":{},"sourceType":"module"}